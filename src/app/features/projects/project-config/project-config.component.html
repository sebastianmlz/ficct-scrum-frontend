<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-100 animate-fade-in">
    <header class="bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 shadow-xl rounded-b-2xl animate-fade-in">
        <div class="max-w-7xl mx-auto py-7 px-6 flex items-center justify-between">
            <div class="flex items-center gap-5">
                <a [routerLink]="['/projects', projectId]" class="p-2 rounded-xl text-white hover:text-pink-100 hover:bg-white/10 transition shadow-lg">
                    <i class="pi pi-arrow-left text-2xl"></i>
                </a>
                <div>
                    <h1 class="text-3xl font-extrabold text-white drop-shadow flex items-center gap-2"><i class="pi pi-cog"></i> Configuración del proyecto</h1>
                    @if (project()) {
                    <p class="text-sm text-white/80 mt-1 font-semibold"><i class="pi pi-briefcase mr-1"></i> {{ project()!.name }}</p>
                    }
                </div>
            </div>
            @if (project()) {
            <div class="flex items-center gap-3">
                <a [routerLink]="['/projects', projectId, 'edit']"
                    class="px-5 py-2 text-sm font-bold text-white bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-xl shadow-lg hover:scale-105 transition flex items-center gap-2">
                    <i class="pi pi-pencil"></i> Editar proyecto
                </a>
            </div>
            }
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-10 sm:px-6 lg:px-8">
        <div class="px-4 py-6 sm:px-0">
            @if (loading()) {
            <div class="flex justify-center items-center py-12">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
            </div>
            } @else if (loadError()) {
            <div class="bg-red-50 border border-red-200 rounded-md p-4">
                <div class="flex">
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-red-800">Error loading project</h3>
                        <p class="mt-1 text-sm text-red-700">{{ loadError() }}</p>
                    </div>
                </div>
            </div>
            } @else {
            <div class="grid grid-cols-1 gap-8 lg:grid-cols-4">
                <!-- Settings Navigation Modernizada -->
                <div class="lg:col-span-1">
                    <nav class="space-y-3 bg-gradient-to-br from-blue-100 via-white to-purple-100 rounded-2xl shadow-xl p-6 animate-fade-in">
                        <button (click)="setActiveTab('general')" [class]="getTabClass('general')"
                            class="group w-full flex items-center px-4 py-3 text-sm font-bold rounded-xl transition border-2 border-transparent hover:border-purple-400 hover:bg-purple-50 text-gray-700 hover:text-purple-700">
                            <i class="pi pi-sliders-h text-lg mr-3"></i> General
                        </button>
                        <button (click)="setActiveTab('features')" [class]="getTabClass('features')"
                            class="group w-full flex items-center px-4 py-3 text-sm font-bold rounded-xl transition border-2 border-transparent hover:border-purple-400 hover:bg-purple-50 text-gray-700 hover:text-purple-700">
                            <i class="pi pi-list text-lg mr-3"></i> Funcionalidades
                        </button>
                        <button (click)="setActiveTab('notifications')" [class]="getTabClass('notifications')"
                            class="group w-full flex items-center px-4 py-3 text-sm font-bold rounded-xl transition border-2 border-transparent hover:border-purple-400 hover:bg-purple-50 text-gray-700 hover:text-purple-700">
                            <i class="pi pi-bell text-lg mr-3"></i> Notificaciones
                        </button>
                        <button (click)="setActiveTab('integrations')" [class]="getTabClass('integrations')"
                            class="group w-full flex items-center px-4 py-3 text-sm font-bold rounded-xl transition border-2 border-transparent hover:border-purple-400 hover:bg-purple-50 text-gray-700 hover:text-purple-700">
                            <i class="pi pi-link text-lg mr-3"></i> Integraciones
                        </button>
                        <button (click)="setActiveTab('danger')" [class]="getTabClass('danger')"
                            class="group w-full flex items-center px-4 py-3 text-sm font-bold rounded-xl transition border-2 border-transparent hover:border-pink-400 hover:bg-pink-50 text-pink-700">
                            <i class="pi pi-exclamation-triangle text-lg mr-3"></i> Zona peligrosa
                        </button>
                    </nav>
                </div>

                <!-- Settings Content Modernizada -->
                <div class="lg:col-span-3">
                    <!-- General Settings Tab -->
                    @if (activeTab() === 'general') {
                    <div class="bg-gradient-to-br from-blue-100 via-white to-purple-100 rounded-2xl shadow-xl border border-purple-100 animate-fade-in">
                        <div class="px-8 py-6 border-b border-purple-200">
                            <h3 class="text-xl font-bold text-purple-700 flex items-center gap-2"><i class="pi pi-sliders-h"></i> General</h3>
                            <p class="mt-1 text-sm text-purple-600">
                                Configura los ajustes básicos y preferencias del proyecto.
                            </p>
                        </div>

                        @if (saveError()) {
                        <div class="mx-6 mt-4 bg-red-50 border border-red-200 rounded-md p-4">
                            <div class="flex">
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-red-800">Error saving settings</h3>
                                    <p class="mt-1 text-sm text-red-700">{{ saveError() }}</p>
                                </div>
                            </div>
                        </div>
                        }

                        @if (successMessage()) {
                        <div class="mx-6 mt-4 bg-green-50 border border-green-200 rounded-md p-4">
                            <div class="flex">
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-green-800">Success</h3>
                                    <p class="mt-1 text-sm text-green-700">{{ successMessage() }}</p>
                                </div>
                            </div>
                        </div>
                        }

                        <form [formGroup]="configForm" (ngSubmit)="onSaveConfig()" class="p-8 space-y-8">
                            <div>
                                <label class="text-sm font-medium text-gray-900">Project Visibility</label>
                                <p class="text-sm text-gray-500">Choose who can view this project</p>
                                <div class="mt-2 space-y-2">
                                    <div class="flex items-center">
                                        <input id="public" type="radio" formControlName="visibility" value="public"
                                            class="h-4 w-4 text-primary focus:ring-primary border-gray-300" />
                                        <label for="public" class="ml-3 block text-sm text-gray-700">
                                            <span class="font-medium">Public</span> - Anyone can view this project
                                        </label>
                                    </div>
                                    <div class="flex items-center">
                                        <input id="internal" type="radio" formControlName="visibility" value="internal"
                                            class="h-4 w-4 text-primary focus:ring-primary border-gray-300" />
                                        <label for="internal" class="ml-3 block text-sm text-gray-700">
                                            <span class="font-medium">Internal</span> - Only organization members can
                                            view
                                        </label>
                                    </div>
                                    <div class="flex items-center">
                                        <input id="private" type="radio" formControlName="visibility" value="private"
                                            class="h-4 w-4 text-primary focus:ring-primary border-gray-300" />
                                        <label for="private" class="ml-3 block text-sm text-gray-700">
                                            <span class="font-medium">Private</span> - Only project members can view
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-900">Allow Comments</label>
                                        <p class="text-sm text-gray-500">Enable commenting on tasks and issues</p>
                                    </div>
                                    <input type="checkbox" formControlName="allow_comments"
                                        class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded" />
                                </div>

                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-900">Allow Attachments</label>
                                        <p class="text-sm text-gray-500">Allow file uploads on tasks</p>
                                    </div>
                                    <input type="checkbox" formControlName="allow_attachments"
                                        class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded" />
                                </div>

                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-900">Time Tracking</label>
                                        <p class="text-sm text-gray-500">Enable time logging on tasks</p>
                                    </div>
                                    <input type="checkbox" formControlName="enable_time_tracking"
                                        class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded" />
                                </div>

                                <div class="flex items-center justify-between">
                                    <div>
                                        <label class="text-sm font-medium text-gray-900">Auto Archive</label>
                                        <p class="text-sm text-gray-500">Archive completed tasks automatically</p>
                                    </div>
                                    <input type="checkbox" formControlName="auto_archive_completed"
                                        class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded" />
                                </div>
                            </div>

                            <div class="pt-8 border-t border-purple-200">
                                <div class="flex justify-end">
                                    <button type="submit" [disabled]="saving()"
                                        class="bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 border border-transparent rounded-xl shadow-lg py-3 px-6 text-sm font-bold text-white hover:scale-105 transition flex items-center gap-2 disabled:opacity-50">
                                        @if (saving()) {
                                        <div class="flex items-center">
                                            <span class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></span>
                                            Guardando...
                                        </div>
                                        } @else {
                                        <i class="pi pi-save"></i> Guardar cambios
                                        }
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                    }

                    <!-- Features Tab -->
                    @if (activeTab() === 'features') {
                    <div class="bg-gradient-to-br from-pink-100 via-white to-blue-100 rounded-2xl shadow-xl border border-pink-100 animate-fade-in">
                        <div class="px-8 py-6 border-b border-pink-200">
                            <h3 class="text-xl font-bold text-pink-700 flex items-center gap-2"><i class="pi pi-list"></i> Funcionalidades</h3>
                            <p class="mt-1 text-sm text-pink-600">
                                Configura qué funcionalidades están habilitadas para este proyecto.
                            </p>
                        </div>
                        <div class="p-8">
                            <div class="grid grid-cols-1 gap-8 sm:grid-cols-2">
                                <div class="bg-gradient-to-br from-green-100 via-white to-blue-100 rounded-xl p-6 shadow border border-green-200 animate-fade-in">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-base font-bold text-green-700 flex items-center gap-2"><i class="pi pi-check"></i> Gestión de tareas</h4>
                                            <p class="text-sm text-green-600">Crear y gestionar tareas</p>
                                        </div>
                                        <span class="inline-flex px-3 py-1 text-xs font-bold rounded-full bg-green-200 text-green-900">
                                            Activo
                                        </span>
                                    </div>
                                </div>
                                <div class="bg-gradient-to-br from-blue-100 via-white to-pink-100 rounded-xl p-6 shadow border border-blue-200 animate-fade-in">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-base font-bold text-blue-700 flex items-center gap-2"><i class="pi pi-bug"></i> Seguimiento de issues</h4>
                                            <p class="text-sm text-blue-600">Reportar y seguir bugs</p>
                                        </div>
                                        <span class="inline-flex px-3 py-1 text-xs font-bold rounded-full bg-blue-200 text-blue-900">
                                            Planeado
                                        </span>
                                    </div>
                                </div>
                                <div class="bg-gradient-to-br from-purple-100 via-white to-blue-100 rounded-xl p-6 shadow border border-purple-200 animate-fade-in">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-base font-bold text-purple-700 flex items-center gap-2"><i class="pi pi-book"></i> Wiki/Documentación</h4>
                                            <p class="text-sm text-purple-600">Documentación del proyecto</p>
                                        </div>
                                        <span class="inline-flex px-3 py-1 text-xs font-bold rounded-full bg-purple-200 text-purple-900">
                                            Planeado
                                        </span>
                                    </div>
                                </div>
                                <div class="bg-gradient-to-br from-pink-100 via-white to-blue-100 rounded-xl p-6 shadow border border-pink-200 animate-fade-in">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-base font-bold text-pink-700 flex items-center gap-2"><i class="pi pi-folder"></i> Almacenamiento de archivos</h4>
                                            <p class="text-sm text-pink-600">Subir y gestionar archivos</p>
                                        </div>
                                        <span class="inline-flex px-3 py-1 text-xs font-bold rounded-full bg-pink-200 text-pink-900">
                                            Planeado
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    }

                    <!-- Notifications Tab -->
                    @if (activeTab() === 'notifications') {
                    <div class="bg-gradient-to-br from-yellow-100 via-white to-purple-100 rounded-2xl shadow-xl border border-yellow-200 animate-fade-in">
                        <div class="px-8 py-6 border-b border-yellow-200">
                            <h3 class="text-xl font-bold text-yellow-700 flex items-center gap-2"><i class="pi pi-bell"></i> Notificaciones</h3>
                            <p class="mt-1 text-sm text-yellow-600">
                                Configura cuándo y cómo los miembros reciben notificaciones.
                            </p>
                        </div>
                        <div class="p-8 space-y-6">
                            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-xl">
                                <div class="flex">
                                    <div class="ml-3">
                                        <p class="text-sm text-yellow-700">
                                            Las notificaciones se gestionan a nivel de workspace.<br>
                                            <a [routerLink]="['/workspaces', project()?.workspace?.id, 'edit']"
                                                class="font-bold underline text-yellow-800">
                                                Configurar notificaciones del workspace
                                            </a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    }

                    <!-- Integrations Tab -->
                    @if (activeTab() === 'integrations') {
                    <div class="bg-gradient-to-br from-blue-100 via-white to-pink-100 rounded-2xl shadow-xl border border-blue-100 animate-fade-in">
                        <div class="px-8 py-6 border-b border-blue-200">
                            <h3 class="text-xl font-bold text-blue-700 flex items-center gap-2"><i class="pi pi-link"></i> Integraciones</h3>
                            <p class="mt-1 text-sm text-blue-600">
                                Conecta tu proyecto con herramientas y servicios externos.
                            </p>
                        </div>
                        <div class="p-8">
                            <!-- GitHub Integration -->
                            <div class="mb-6">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">GitHub Integration</h4>
                                <app-github-integration [projectId]="projectId"></app-github-integration>
                            </div>
                        </div>
                    </div>
                    }

                    <!-- Danger Zone Tab -->
                    @if (activeTab() === 'danger') {
                    <div class="bg-gradient-to-br from-pink-100 via-white to-red-100 rounded-2xl shadow-xl border border-pink-200 animate-fade-in">
                        <div class="px-8 py-6 border-b border-pink-200 bg-pink-50 rounded-t-2xl">
                            <h3 class="text-xl font-bold text-pink-700 flex items-center gap-2"><i class="pi pi-exclamation-triangle"></i> Zona peligrosa</h3>
                            <p class="mt-1 text-sm text-pink-600">
                                Estas acciones son irreversibles. Por favor, ten cuidado.
                            </p>
                        </div>
                        <div class="p-8 space-y-8">
                            <div class="border border-yellow-300 rounded-xl p-6 bg-yellow-50 shadow">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="text-base font-bold text-yellow-700 flex items-center gap-2"><i class="pi pi-archive"></i> Archivar proyecto</h4>
                                        <p class="text-sm text-yellow-700 mt-1">
                                            Archiva este proyecto. Se ocultará de la lista principal pero puede restaurarse luego.
                                        </p>
                                    </div>
                                    <button type="button" (click)="archiveProject()" [disabled]="!project()?.is_active"
                                        class="ml-4 bg-gradient-to-r from-yellow-500 via-yellow-600 to-yellow-700 border border-transparent rounded-xl py-2 px-5 text-sm font-bold text-white shadow-lg hover:scale-105 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
                                        <i class="pi pi-archive"></i> Archivar
                                    </button>
                                </div>
                            </div>
                            <div class="border border-red-300 rounded-xl p-6 bg-red-50 shadow">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="text-base font-bold text-red-700 flex items-center gap-2"><i class="pi pi-trash"></i> Eliminar proyecto</h4>
                                        <p class="text-sm text-red-700 mt-1">
                                            Elimina permanentemente este proyecto y todos sus datos. Esta acción no se puede deshacer.
                                        </p>
                                    </div>
                                    <button type="button" (click)="confirmDeleteProject()"
                                        class="ml-4 bg-gradient-to-r from-red-500 via-pink-500 to-red-700 border border-transparent rounded-xl py-2 px-5 text-sm font-bold text-white shadow-lg hover:scale-105 transition flex items-center gap-2">
                                        <i class="pi pi-trash"></i> Eliminar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    }
                </div>
            </div>
            }
        </div>
    </main>
</div>